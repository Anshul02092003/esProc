<!--create by iword1.0 pro, http://www.voland.com.cn-->
<!-- saved from url=(0026)http://www.runqian.com.cn/ -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>11.1 Big data and cursor</title>
<link rel="stylesheet" href="../images/template.css" type="text/css" />
<link rel="stylesheet" href="document.css" type="text/css" />
<script language="JavaScript" src="../resource/url.js"></script>
</head>

<body>

<div id="content-bg">
	<div id="centent">
	<div id="centent-title"><h2 style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;margin-left:
0cm;text-indent:0cm;line-height:normal;mso-list:l11 level2 lfo12;tab-stops:
list 36.0pt left 42.55pt'><span lang=EN-US
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>11.1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><span
lang=EN-US>Big data and cursor </span></h2></div>
	<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>We¡¯ll talk about how to deal with big data in
this chapter.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The so-called big data here refers to the
data that cannot be loaded in the memory. It is generally stored on the hard
disk in the form of file or in the database (also on the hard disk). </span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>This book does not involve the database, but
only the big data in the file.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Excel files are generally not too large (it
has the maximum number of rows). Large files are usually in the txt or csv
format mentioned before. According to the memory of modern computers, it takes
tens of millions or even hundreds of millions of lines (number of records) of
data to be big, and the file size will be several G or dozens of G or more.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>In fact, we rarely encounter such a large
amount of data in our daily desktop work, so the operation methods mentioned
before are sufficient in most scenarios. However, as a complete book, we still
introduce the processing methods of big data.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Is there any difference between big data and
the data we processed earlier? Can't the methods we learned earlier be used?</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The processing methods described in the
previous chapters are all for data in memory. The file data used is also
processed after being read into memory.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Because the CPU can only directly process the
data in memory, it can not directly process the hard disk and other non memory
data.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Can we do this: give an address for all the
data on the hard disk, temporarily read it into the memory from the hard disk
when we need to use it, throw it away when it has been used, and write it back
to the hard disk if we need to change it, and this way it looks like directly
operating a large piece of memory.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>In theory, it is possible. Indeed, there are
programs in some scenarios that do this (Windows has a system cache to do
this). But it is hard for structured data operation to do this.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Is that because there is any essential
difference between memory and hard disk?</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Yes, in IT terms, memory allows <b
style='mso-bidi-font-weight:normal'>random small-piece accessing</b>, that is,
the data under an address can be retrieved by randomly giving the address of a
piece of memory. For example, when using a sequence, we can access any member
with a sequence number.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The hard disk can't do that.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The hard disk is more suitable for <b>continuous
batch accessing</b>. It can only read and write the whole block, at least one
minimum unit at a time (the specific size is related to the operating system.
At present, most computers are 4096 bytes, and bytes are used to measure the
space occupied by data. It doesn't matter if you don't understand it, and it
doesn't affect your understanding), and to only read an integer (only 4 or 8
bytes, and it will be smaller if compressed) will have to read in the whole
block. If a large number of small pieces of data at various addresses are read
(many places are accessed, and each place has a small piece of data, which is
actually a very common situation), the amount of data read is actually very
large, resulting in poor performance. The old mechanical hard disk can not
support high-frequency random access (even reading the whole block), and the
performance degradation is very serious.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Because of these troubles, for the scenario
of structured data operation, no one simulates the hard disk as memory.
Moreover, what's more troublesome is that the operating system does not do any
special work for structured data. It only reads and writes file for the data on
the hard disk, while operating files is a very complex thing, and this will
further reduce the performance.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>What can we do?</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>We can't directly access the structured data
on the hard disk with the previous method. We usually use<b> cursor </b>technology
to complete the operation.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>When we open a data file, the cursor is like
a pointer. First it points to the first record of the file, and then several records
can be read into memory for processing. During the reading process, the cursor
pointer will also move forward. After the data in memory is processed and
discarded, and then read the next batch from the current position of the cursor
for processing, ..., it is repeated until all the data are read into memory and
processed.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Because the cursor will read a batch of data
every time, it usually occupies multiple blocks of the hard disk, and this is
actually batch continuous access, and the difficulty of hard disk is avoided.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>However, due to the special structure of most
data files such as txt and csv, the cursor usually can only move forward, not backward
(the cost of moving backward is very high). </span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Even moving forward, it can't jump and can
only traverse row by row. In other words, accessing data with a cursor has lost
randomness.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Therefore, many of the operation methods
mentioned before can not be used. We need to design a set of functions for the
cursor.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Let's talk about cursor related functions.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>In order to do the experiment, we first
generate a large file, a simplified order table.</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=921
 style='border-collapse:collapse;mso-table-layout-alt:fixed;border:none;
 mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:#B2B2B2;
 mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:
 .5pt solid #B2B2B2;mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=34 valign=top style='width:20.2pt;border:solid black 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>
  </td>
  <td width=40 valign=top style='width:23.85pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>A</span></p>
  </td>
  <td width=848 valign=top style='width:508.65pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>B</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=34 style='width:20.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></p>
  </td>
  <td width=888 colspan=2 valign=top style='width:532.5pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'><span
  style='mso-spacerun:yes'>&nbsp;</span>[East,West,North,South,Center]</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=34 style='width:20.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>2</span></p>
  </td>
  <td width=40 valign=top style='width:23.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>for 0,999</span></p>
  </td>
  <td width=848 valign=top style='width:508.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=10000.new(A2*10000+~:id,A1(rand(5)+1):area,date(now())-1000+A2:dt,1+rand(10000):amount,1+rand(100):quantity)</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;page-break-inside:avoid;height:14.15pt'>
  <td width=34 style='width:20.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>3</span></p>
  </td>
  <td width=40 valign=top style='width:23.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
  <td width=848 valign=top style='width:508.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=B2.select(rand()&gt;=0.01)</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=34 style='width:20.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>4</span></p>
  </td>
  <td width=40 valign=top style='width:23.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
  <td width=848 valign=top style='width:508.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&gt;file(&quot;data.txt&quot;).export@at(B3)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The export() function will write the table
sequence to the file, @a option means to append when writing. Thus, the file
will be appended 1000 times, and less than 10000 records will be written each
time (a part will be discarded randomly in B3), with a total of less than 10
million records. @t means that the first line of the file writes the field names
as the title, which is the same as @t in xlsimport().</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The id field can act as the primary key, but
the primary key cannot be really established in the file data. dt is the date.
The data generated each time is of the same day and it increases with the loop
variable A2, which can ensure that the date is orderly (which will be used
later), and the time information of now() needs to be discarded. amount and quantity
can be generated randomly.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Note that the original data.txt should be
deleted before execution, otherwise a batch of data will be added after the current
file. In addition, it's better to add the absolute path of the file in actual
use, otherwise you may not find where the file is written because the current
path is uncertain.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Let's first count the total number of records
in this file.</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=473
 style='border-collapse:collapse;mso-table-layout-alt:fixed;border:none;
 mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:#B2B2B2;
 mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:
 .5pt solid #B2B2B2;mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=32 valign=top style='width:18.9pt;border:solid black 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>
  </td>
  <td width=63 valign=top style='width:37.8pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>A</span></p>
  </td>
  <td width=272 valign=top style='width:163.0pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>B</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>C</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></p>
  </td>
  <td width=63 valign=top style='width:37.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=0</span></p>
  </td>
  <td width=272 valign=top style='width:163.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=file(&quot;data.txt&quot;).cursor@t()</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>2</span></p>
  </td>
  <td width=63 valign=top style='width:37.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>for</span></p>
  </td>
  <td width=272 valign=top style='width:163.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=B1.fetch(10000)</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;page-break-inside:avoid;height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>3</span></p>
  </td>
  <td width=63 valign=top style='width:37.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
  <td width=272 valign=top style='width:163.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>if B2==null</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>break</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>4</span></p>
  </td>
  <td width=63 valign=top style='width:37.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
  <td width=272 valign=top style='width:163.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&gt;A1+=B2.len()</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The cursor() function will open the file and
create a cursor (also a complex object), @t indicating that the first line of
the file is the title. The fetch() function of the cursor will read out a table
sequence composed of a specified number of records (with the title as the field
name) and move forward. The next fetch() will be the next batch of records. If the
end of the file is encountered in the process of reading, all the remaining
records will be read, therefore, the desired number of records may not always
be read out. When there is nothing to be read (end of file), null will be
returned.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>If we understand the above knowledge, this
code is easy to understand. Do an endless loop, read 10000 records each time,
and jump out of the loop after the reading is finished. In the process, add up
the number of records read each time to get the result, which is stored in A1.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>On this basis, let's calculate the average order
amount:</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=473
 style='border-collapse:collapse;mso-table-layout-alt:fixed;border:none;
 mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:#B2B2B2;
 mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:
 .5pt solid #B2B2B2;mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=32 valign=top style='width:18.9pt;border:solid black 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>
  </td>
  <td width=63 valign=top style='width:37.8pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>A</span></p>
  </td>
  <td width=272 valign=top style='width:163.0pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>B</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>C</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></p>
  </td>
  <td width=63 valign=top style='width:37.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=0</span></p>
  </td>
  <td width=272 valign=top style='width:163.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=file(&quot;data.txt&quot;).cursor@t()</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=0</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>2</span></p>
  </td>
  <td width=63 valign=top style='width:37.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>for</span></p>
  </td>
  <td width=272 valign=top style='width:163.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=B1.fetch(10000)</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;page-break-inside:avoid;height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>3</span></p>
  </td>
  <td width=63 valign=top style='width:37.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
  <td width=272 valign=top style='width:163.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>if B2==null</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>break</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;page-break-inside:avoid;height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>4</span></p>
  </td>
  <td width=63 valign=top style='width:37.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
  <td width=272 valign=top style='width:163.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&gt;A1+=B2.len()</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;page-break-inside:avoid;height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>5</span></p>
  </td>
  <td width=63 valign=top style='width:37.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
  <td width=272 valign=top style='width:163.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&gt;C1+=B2.sum(amount)</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>6</span></p>
  </td>
  <td width=335 colspan=2 valign=top style='width:200.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=C1/A1</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The sum can also be calculated in the same
loop.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>To calculate the sum, we only need to read
the amount field; and to count the number of records, randomly reading one
field is enough. It's not necessary to read all the fields. If we read less,
the speed will be faster (as can be seen from the previous discussion, the
amount of data read from the hard disk is almost the same, but reading fewer
fields will make the processing of file reading easier):</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=520
 style='border-collapse:collapse;mso-table-layout-alt:fixed;border:none;
 mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:#B2B2B2;
 mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:
 .5pt solid #B2B2B2;mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=32 valign=top style='width:18.9pt;border:solid black 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>
  </td>
  <td width=63 valign=top style='width:37.8pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>A</span></p>
  </td>
  <td width=319 valign=top style='width:191.35pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>B</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>C</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></p>
  </td>
  <td width=63 valign=top style='width:37.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=0</span></p>
  </td>
  <td width=319 valign=top style='width:191.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=file(&quot;data.txt&quot;).cursor@t(amount)</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=0</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>2</span></p>
  </td>
  <td width=63 valign=top style='width:37.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>for</span></p>
  </td>
  <td width=319 valign=top style='width:191.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=B1.fetch(10000)</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;page-break-inside:avoid;height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>3</span></p>
  </td>
  <td width=63 valign=top style='width:37.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
  <td width=319 valign=top style='width:191.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>if B2==null</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>break</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;page-break-inside:avoid;height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>4</span></p>
  </td>
  <td width=63 valign=top style='width:37.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
  <td width=319 valign=top style='width:191.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&gt;A1+=B2.len()</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;page-break-inside:avoid;height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>5</span></p>
  </td>
  <td width=63 valign=top style='width:37.8pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
  <td width=319 valign=top style='width:191.35pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&gt;C1+=B2.sum(amount)</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>6</span></p>
  </td>
  <td width=382 colspan=2 valign=top style='width:229.15pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=C1/A1</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>We can write the fields to be read in the
parameter of the cursor() function, so that the table sequence fetched will
have only a few fields, and the unnecessary fields do not have to be read in.
This is an important difference between external storage calculation and
in-memory calculation. We never pay attention to this problem in in-memory
calculation.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The structure of this endless loop is a fixed
pattern. It is a little troublesome to write every time. In addition, it may
happen that B3 is forgotten to write or written wrong, which will really become
an endless loop. SPL actually supports direct looping against cursor:</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=520
 style='border-collapse:collapse;mso-table-layout-alt:fixed;border:none;
 mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:#B2B2B2;
 mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:
 .5pt solid #B2B2B2;mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=32 valign=top style='width:18.9pt;border:solid black 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>
  </td>
  <td width=122 valign=top style='width:73.2pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>A</span></p>
  </td>
  <td width=319 valign=top style='width:191.4pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>B</span></p>
  </td>
  <td width=47 valign=top style='width:1.0cm;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>C</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></p>
  </td>
  <td width=122 valign=top style='width:73.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=0</span></p>
  </td>
  <td width=319 valign=top style='width:191.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=file(&quot;data.txt&quot;).cursor@t(amount)</span></p>
  </td>
  <td width=47 valign=top style='width:1.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=0</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>2</span></p>
  </td>
  <td width=122 valign=top style='width:73.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>for B1,10000</span></p>
  </td>
  <td width=319 valign=top style='width:191.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&gt;A1+=A2.len()</span></p>
  </td>
  <td width=47 valign=top style='width:1.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;page-break-inside:avoid;height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>3</span></p>
  </td>
  <td width=122 valign=top style='width:73.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
  <td width=319 valign=top style='width:191.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&gt;C1+=A2.sum(amount)</span></p>
  </td>
  <td width=47 valign=top style='width:1.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=32 style='width:18.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>4</span></p>
  </td>
  <td width=441 colspan=2 valign=top style='width:264.6pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=C1/A1</span></p>
  </td>
  <td width=47 valign=top style='width:1.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&nbsp;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The for statement can loop through the
cursor, the following integer is the number of records read out each cycle, and
the loop variable is the table sequence read in. When the data cannot be read
out, the loop will naturally stop, so there is no need to write fetch() and end
conditions, and the code is simpler.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Using loop, the data in the cursor (actually
the data in the file used to create the cursor, and we will often use this saying
later) is read completely in turn. The process of this operation is called <b>traversal
</b>of the cursor. Recalling the previous rules, the cursor traversal can only
move forward, and can only traverse once. After all the data in the cursor has
been read once, the cursor traversal ends, and the cursor is useless and can no
longer read data. To read the data from the beginning again, you have to recreate
a new cursor.</span></p>
	</div>
	<div id="previous-next">
		<div id="next"><a href="54.html">Next</a></div>
		<div id="previous"><a href="52.html">Previous</a></div>		
	</div>
	<div id="related">
		<div class="related-title"><div class="related-title-left"></div>   Related :</div>
		<div class="related-list"><li><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'><a href="52.html">11 Big data</a></span></li>
</div>
	</div>
	<div id="footer">	
		
		
    <div class="copyright"> Copyright&reg; 2021-2023 <a href="http://www.scudata.com" target="_Blank">SCUDATA Inc. 
      </a></div>
	</div>
</div>

</body>
</html>
