<!--create by iword1.0 pro, http://www.voland.com.cn-->
<!-- saved from url=(0026)http://www.runqian.com.cn/ -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>11.8.4 Dimensions in DQL</title>
<link rel="stylesheet" href="../images/template.css" type="text/css" />
<link rel="stylesheet" href="document.css" type="text/css" />
<script language="JavaScript" src="../resource/url.js"></script>
</head>

<body>

<div id="content-bg">
	<div id="centent">
	<div id="centent-title"><h3 style='margin-left:39.0pt;text-indent:-39.0pt;mso-list:l26 level3 lfo55;
tab-stops:21.0pt'><span lang=EN-US style='mso-fareast-font-family:
"Times New Roman"'><span style='mso-list:Ignore'>11.8.4<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span lang=EN-US>Dimensions in DQL</span></h3></div>
	<p class=T-ParCxSpFirst style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-ansi-language:#0400'>In a pseudo
table in use, some fields are likely to be used as <b>foreign key fields</b> that
will relate to the primary key of a certain table. Such a table associated to one
or part of the foreign key is called <b>dimension table</b>. In the dimension
table, primary key field must be unique and the foreign key field associated to
it is called <b>dimension field</b>. During DQL configurations, if a dimension
table is linked to the dimension field of another table, the dimension table
must be loaded into the memory, like the following seller information table:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US style='mso-no-proof:yes'><img border=0 width=692 height=502
src="Tutorial.files/image2232.jpg" v:shapes="_x0000_i2234"></span><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>Data in pseudo table <i>sellers</i> also comes from <i>emps.ctx</i>.
We need to select ¡°Load into memory¡± to load <i>sellers</i> into the memory and
uses it as the dimension table. Only EID, DeptID and Name fields are selected
and the other fields are discarded with filter condition DeptID==1 used to get
employees working in the Sales department only. After the dimension table is
defined, set it as a DQL table as follows:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US style='mso-no-proof:yes'><img border=0 width=692 height=315
src="Tutorial.files/image2234.jpg" v:shapes="_x0000_i2235"></span><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>Query data in<i> sellers</i> table in DQL query window:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US style='mso-no-proof:yes'><img border=0 width=692 height=397
src="Tutorial.files/image2235.png" v:shapes="_x0000_i2236"></span><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>The dimension table just contains sellers information and retains useful
fields only.</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>On Pseudo table tab, after setting the dimension table as an in-memory
table we can associate it to the foreign key of another pseudo table. In the following
interface, we change the configurations of <i>var_orders</i> and add a foreign
key field under the user-defined field:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US style='mso-no-proof:yes'><img border=0 width=692 height=325
src="Tutorial.files/image2236.png" v:shapes="_x0000_i2237"></span><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>The newly-added foreign key field in the pseudo table will associate
to dimension table <i>var_sellers</i> through SID.</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>Now pseudo table <i>var_orders</i>¡¯s definition is changed. In the
DQL table definition, delete definition of the original table <i>orders</i> and
generate the DQL table according to the modified pseudo t able definition. Foreign
key settings are added to <i>orders</i>:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US style='mso-no-proof:yes'><img border=0 width=692 height=372
src="Tutorial.files/image2237.png" v:shapes="_x0000_i2238"></span><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>The foreign key settings are consistent with the foreign key field
settings in the pseudo table. The foreign key field SID is associated with dimension
table <i>sellers</i>, and EID is the dimension table¡¯s EID. After the foreign key
is set for a DQL table, we can directly query the foreign key field on DQL
query tab, as shown below:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US style='mso-no-proof:yes'><img border=0 width=692 height=372
src="Tutorial.files/image2237.png" v:shapes="_x0000_i2239"></span><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>By setting the foreign key for a DQL table, we can query <span
class=T-Var>F </span>field in the dimension table corresponding to the foreign
key <span class=T-Var>fk</span> in DQL query tab using syntax <span
class=T-Var>fk</span>.<span class=T-Var>F</span>. For example:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US style='mso-no-proof:yes'><img border=0 width=692 height=487
src="Tutorial.files/image2239.jpg" v:shapes="_x0000_i2240"></span><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>The above DQL table invokes sellers¡¯ names thourgh SID.Name. In more
occasions, the table¡¯s foreign key is used to perform a filtering. For example:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US style='mso-no-proof:yes'><img border=0 width=685 height=539
src="Tutorial.files/image2241.jpg" v:shapes="_x0000_i2241"></span><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>On the DQL settings window¡¯s <span class=T-Bold>Dim and level </span>page,
we can view all DQL tables¡¯ all dimension tables and dimension hierarchies:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US style='mso-no-proof:yes'><img border=0 width=692 height=246
src="Tutorial.files/image2243.jpg" v:shapes="_x0000_i2242"></span><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>A dimension table can be simply called <b>dimension</b>. Any table whose
primary key field contains unique values and does not act as the foreign key
can be a dimension table. Besides the <i>sellers</i> table, the other DQL
tables, such as <i>emps</i>, <i>orders2</i> and <i>orders</i>, also meet the dimension
table standard for being related to <i>orders</i> table¡¯s foreign key and are thus
listed in the dimension list.</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>In the above example displaying how a dimension table is used, the <i>sellers</i>
table is real. In addition to the physically existed tables, we can use the physically
nonexistent but logically designed tables as dimension tables. We call such
tables <b>logical tables</b> and often use them for date handling.</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>On DQL¡¯s Table tab, we add several date-related logical tables.
Select Edit-&gt;Add logical table on the menu bar to add a logical table
definition:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US style='mso-no-proof:yes'><img border=0 width=310 height=188
src="Tutorial.files/image2245.jpg" v:shapes="_x0000_i2243"></span><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US>The new logical table is named <i>Day</i>.
Click ¡°Add¡± icon <span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-no-proof:yes'><img border=0 width=34 height=33
src="Tutorial.files/image2247.jpg" v:shapes="_x0000_i2244"><span
style='mso-spacerun:yes'>&nbsp;</span>to add a field definition. The field is
defined as day:</span></span><span lang=zh-CN style='mso-ansi-language:#0400;
mso-fareast-language:#0400'></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US style='mso-no-proof:yes'><img border=0 width=693 height=283
src="Tutorial.files/image2249.jpg" v:shapes="_x0000_i2245"></span><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>Only one primary key field can be defined for a logical table. A
logical table amounts to a table containing only one field. Default is selected
for the data type of our date-related logical table. Actually, the logical
table will be related to a datetime type field. That is to say, logical table <i>Day</i>¡¯s
field type is date. We call such type of logical tables <b>date dimensions</b>.
On the DQL table definition window, logical tables have different icons from other
DQL tables.</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>Now we add another two logical tables &#8211; <i>YearMonth</i> and <i>Quarter</i>
and use them as time-related dimension tables &#8211; the <i>YearMonth</i> dimension
and <i>Quarter</i> dimension:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US style='mso-no-proof:yes'><img border=0 width=692 height=275
src="Tutorial.files/image2251.jpg" v:shapes="_x0000_i2246"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US style='mso-no-proof:yes'><img border=0 width=692 height=275
src="Tutorial.files/image2253.jpg" v:shapes="_x0000_i2247"></span><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>The <i>YearMonth</i> table is used to store the year part and month part
of date values, and the <i>Quarter</i> table will store quarters that dates
belong to. Data types of both dimension tables are integers, and we call them <b>integer
dimension</b>.</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>Since all the three logical tables store time data, they are intrinsically
related to each other. Based on <i>Day</i> we can get the year, month and quarter
which a date belongs to; based on <i>YearMonth</i> we can find which quarter a
month falls in. We can represent their associated relationship through a function.
On a dimension table, if it can be linked to another dimension through the
calculation of a function, we call the function <b>hierarchy function</b>. We add
a hierarchy function to dimension table <i>Day</i> and set association
relationships between it and the other two time dimension tables:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US style='mso-no-proof:yes'><img border=0 width=692 height=253
src="Tutorial.files/image2255.jpg" v:shapes="_x0000_i2248"></span><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>On DQL table definition¡¯s Dime and level tab, we set different names
for hierarchy functions and their primary key associations with selected dimension
tables respectively. In a hierarchy function, we use the question mark (?) to represent
a primary key value in the current dimension table. We can get data on
different levels, corresponding to <i>YearMonth</i> dimension table or <i>Quarter</i>
dimension table, by handling date data through the hierarchy function. A hierarchy
function is not bi-directional. We can find the corresponding quarter for a
date but cannot get date according to a quarter value. Likewise, we set the
association between <i>YearMonth</i> dimension table and <i>Quarter</i> dimension
table¡¯s hierarchy function:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US style='mso-no-proof:yes'><img border=0 width=692 height=253
src="Tutorial.files/image2257.jpg" v:shapes="_x0000_i2249"></span><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US>In the following window, we add the
association relationship between <i>orders</i> table and date dimension <i>Day</i>
in the former¡¯s foreign key settings:<span style='mso-no-proof:yes'><img border=0 width=692 height=334
src="Tutorial.files/image2259.jpg" v:shapes="_x0000_i2250"></span></span><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>In <i>orders</i> table, we add a new foreign key <i>fk1</i> that relates
to dimension table <i>Day</i> through the former¡¯s OTime field and the lattter¡¯s
primary key day. By doing so, <i>orders</i> table becomes associated to the
other date-related dimension tables &#8211; <i>YearMonth</i> and <i>Quarter </i>via<i>
Day¡¯</i>s hierarchy function, which can be used in DQL queries. For example:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US style='mso-no-proof:yes'><img border=0 width=692 height=491
src="Tutorial.files/image2261.jpg" v:shapes="_x0000_i2251"></span><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>Through the hierarchy-function-based association, OTime¡¯s date data get
associated with <i>YearMonth</i> dimension table and we can obtain data of the
latter¡¯ ym field. In queries, we use OTime#ym to represent that the values of associated
field ym is obtained through the hierarchy function linked to OTime.</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>We can also use a multilevel dimension to perform data filtering, to
get order records of the second quarter, for example:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=EN-US style='mso-no-proof:yes'><img border=0 width=692 height=491
src="Tutorial.files/image2263.jpg" v:shapes="_x0000_i2252"></span><span
lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:#0400'></span></p>

<p class=T-ParCxSpLast style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>By exploiting dimensions in DQL tables, we can make great use of table
data and meet more real-world business requirements. One dimension table can
relate to foreign keys of multiple tables, and it is convenient to use a dimension
table¡¯s hierarchy function. Take the above date-related dimension as an
example, we can get data on different levels by creating association between a
datetime foreign key and a date dimension table. </span></p>
	</div>
	<div id="previous-next">
		<div id="next"><a href="269.html">Next</a></div>
		<div id="previous"><a href="267.html">Previous</a></div>		
	</div>
	<div id="related">
		<div class="related-title"><div class="related-title-left"></div>   Related :</div>
		<div class="related-list"><li><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'><a href="264.html">11.8 A sketch of DQL</a></span></li>
</div>
	</div>
	<div id="footer">	
		
		<div class="copyright"> Copyright&reg; 2021-2023 <a href="http://www.scudata.com" target="_Blank">Scudata Inc. 
      </a></div> 
        <!--
		<div class="copyright"> Copyright&reg; 2017 <a href="http://www.yimming.com" target="_Blank"> Beijing Yimming Ltd. Co. 
      </a></div>
	  -->
	</div>
</div>

</body>
</html>
