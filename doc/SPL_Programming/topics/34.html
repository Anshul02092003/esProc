<!--create by iword1.0 pro, http://www.voland.com.cn-->
<!-- saved from url=(0026)http://www.runqian.com.cn/ -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>7.2 Split and concatenate</title>
<link rel="stylesheet" href="../images/template.css" type="text/css" />
<link rel="stylesheet" href="document.css" type="text/css" />
<script language="JavaScript" src="../resource/url.js"></script>
</head>

<body>

<div id="content-bg">
	<div id="centent">
	<div id="centent-title"><h2 style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;margin-left:
0cm;text-indent:0cm;line-height:normal;mso-list:l11 level2 lfo12;tab-stops:
list 36.0pt left 42.55pt'><span lang=EN-US
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>7.2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span lang=EN-US>Split and concatenate</span></h2></div>
	<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>We have used the loop function and mid() to split
the string into a sequence of single characters. Because this is very common,
SPL provides the split() function. </span><span class=Charf9><span lang=EN-US
style='font-family:"Times New Roman","serif"'>s.split() </span></span><span
lang=EN-US>is equivalent to </span><span class=Charf9><span lang=EN-US
style='font-family:"Times New Roman","serif"'>len(s).(mid(s,~,1))</span></span><span
lang=EN-US>.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Split() also has more string splitting
capabilities.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>However, before we talk about split, let's
learn a clipboard() function.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Just find a text editing program, such as
Notepad, enter some text, select it, and then press Ctrl-C, which is the
familiar copy action. Now switch to esProc, create a new cellset, enter
=clipboard() in cell A1, and then execute to see the value of cell A1.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The text just copied in Notepad is now here.
The clipboard() function can take out the text copied to the system clipboard.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Then enter in A2</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>&gt;clipboard(&quot;Hello,esProc&quot;)</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>After execution, switch back to Notepad and
press Ctrl-V to paste. What do you see?</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The clipboard() function with a parameter
will copy the string used as a parameter to the system clipboard, and then it
can be pasted in other programs.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Now let's use this clipboard() function to
help Excel do something.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Suppose a column in Excel, such as column A,
has some names. For example, the first few rows are as follows:</span></p>

<p class=MsoNormal align=left style='margin-top:7.8pt;margin-right:0cm;
margin-bottom:7.8pt;margin-left:0cm;text-align:left'><span lang=EN-US
style='mso-no-proof:yes'><img border=0 width=117 height=190
src="SPL_Programming.files/image078.png" v:shapes="图片_x0020_123"></span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Now we want to know how many times the letter
e is used in these names.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>It's not easy for Excel to calculate this.
Let's use SPL to cooperate.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>1) Select this column in Excel, press Ctrl-C
and copy it to the clipboard.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>2) Switch to esProc and write the following
code:</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=343
 style='border-collapse:collapse;mso-table-layout-alt:fixed;border:none;
 mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:#B2B2B2;
 mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:
 .5pt solid #B2B2B2;mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=53 valign=top style='width:31.9pt;border:solid black 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>
  </td>
  <td width=289 valign=top style='width:173.65pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>A</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=53 style='width:31.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></p>
  </td>
  <td width=289 valign=top style='width:173.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=clipboard()</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=53 style='width:31.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>2</span></p>
  </td>
  <td width=289 valign=top style='width:173.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=A1.split(&quot;\n&quot;)</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;page-break-inside:avoid;height:14.15pt'>
  <td width=53 style='width:31.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>3</span></p>
  </td>
  <td width=289 valign=top style='width:173.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=A2.(~.split())</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;page-break-inside:avoid;height:14.15pt'>
  <td width=53 style='width:31.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>4</span></p>
  </td>
  <td width=289 valign=top style='width:173.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=A3.conj()</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=53 style='width:31.9pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>5</span></p>
  </td>
  <td width=289 valign=top style='width:173.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=A4.count(
  lower(~)==&quot;e&quot; )</span></span><span class=code><span lang=EN-US
  style='font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Execute it, A5 is the result we want.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Let's look at each cell value in the script
after the code is executed. A1 is as follows:</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US style='mso-no-proof:yes'><img border=0 width=1053 height=547
src="SPL_Programming.files/image080.jpg" v:shapes="图片_x0020_122"></span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>It takes out the content just copied in Excel
from the clipboard. It seems to squeeze the text in the column of Excel
together. Look at A2:</span></p>

<p class=MsoNormal align=left style='margin-top:7.8pt;margin-right:0cm;
margin-bottom:7.8pt;margin-left:0cm;text-align:left'><span lang=EN-US
style='mso-no-proof:yes'><img border=0 width=391 height=183
src="SPL_Programming.files/image082.jpg" v:shapes="图片_x0020_121"></span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>This is a sequence. Each member is exactly
every row of text in the Excel column. How does this happen?</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>In fact, what we copied from Excel is a large
string composed of these texts, separated by return between the two rows. The
return character is a non displayable character, which can not be seen in
esProc, so it looks like squeezing the text of these rows together. </span><span
class=Charf9><span lang=EN-US style='font-family:"Times New Roman","serif"'>A1.split(&quot;\n&quot;)</span></span><span
lang=EN-US> means that the return character is used as the separator to split
the large string into a sequence, so it returns to the case where each member
exactly corresponds to each row in Excel.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The &quot;\n&quot; here is the return
character. The backslash \ in the string constant is called the <b>escape
character</b>. Its function is to help us write some characters that are
inconvenient to write. For example, return is represented by \n and tab is
represented by \t. These are non displayable characters, but they also have
codes and are two characters. \n is only one character in the string, although
it is written in quotation marks as \ and n (two characters), \t is also
similar.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Because \ is regarded as an escape character,
if we really want to have a \ in the string constant, it will be escaped. It
will be written twice, that is, the actual content of </span><span
class=Charf9><span lang=EN-US style='font-family:"Times New Roman","serif"'>&quot;a\\b&quot;</span></span><span
lang=EN-US> is </span><span class=Charf9><span lang=EN-US style='font-family:
"Times New Roman","serif"'>a\b</span></span><span lang=EN-US>, and the length
is 3; In addition, double quotation marks are used as the delimiter of a
string, but it is still possible that a string contains double quotation marks.
In this case, it should also be written with an escape character. The actual
content of </span><span class=Charf9><span lang=EN-US style='font-family:"Times New Roman","serif"'>&quot;a\&quot;b&quot;
</span></span><span lang=EN-US>is </span><span class=Charf9><span lang=EN-US
style='font-family:"Times New Roman","serif"'>a&quot;b </span></span><span
lang=EN-US>with a length of 3.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The following statements are simple. A3 is a
loop function. Its inner ~.split() will split the string of each member into a
sequence of single characters, so A3 is a two-layer sequence:</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>[[&quot;J&quot;,&quot;a&quot;,&quot;m&quot;,&quot;e&quot;,&quot;s&quot;],[&quot;A&quot;,&quot;n&quot;,&quot;d&quot;,&quot;r&quot;,&quot;e&quot;,&quot;w&quot;],…]</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>We have encountered the conj() function when
we talked about recursion. Its function is to concatenate the member sequences
of a multi-layer sequence and return the result of | operation among these
members. Therefore, A3.conj() in A4 will get:</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>[&quot;J&quot;,&quot;a&quot;,&quot;m&quot;,&quot;e&quot;,&quot;s&quot;,&quot;A&quot;,&quot;n&quot;,&quot;d&quot;,&quot;r&quot;,&quot;e&quot;,&quot;w&quot;,…]</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The lower() function turns the character into
lowercase. Now it can be compared with the string &quot;e&quot;, and then count
it.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>It is written in this way to disassemble the
steps and facilitate the interpretation of the code. In fact, these operations
can be written continuously:</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=343
 style='border-collapse:collapse;mso-table-layout-alt:fixed;border:none;
 mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:#B2B2B2;
 mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:
 .5pt solid #B2B2B2;mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=41 valign=top style='width:24.85pt;border:solid black 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>
  </td>
  <td width=301 valign=top style='width:180.7pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>A</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=41 style='width:24.85pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></p>
  </td>
  <td width=301 valign=top style='width:180.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=clipboard()</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=41 style='width:24.85pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>2</span></p>
  </td>
  <td width=301 valign=top style='width:180.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=A1.split@n().conj()</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=41 style='width:24.85pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>3</span></p>
  </td>
  <td width=301 valign=top style='width:180.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=A2.count(
  lower(~)==&quot;e&quot; )</span></span><span class=code><span lang=EN-US
  style='font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span class=Charf9><span lang=EN-US style='font-family:"Times New Roman","serif"'>s.split@n(x)
is s.split(&quot;\n&quot;).(~.split(x))</span></span><span lang=EN-US>, because
it is common to split by return first and then split again, SPL adds the @n option
to the split function. </span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span class=Charf9><span lang=EN-US style='font-family:"Times New Roman","serif"'>Let’s
take another example.</span></span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span class=Charf9><span lang=EN-US style='font-family:"Times New Roman","serif"'>A
batch of email addresses are stored in a column in Excel. As we know, the email
addresses are x@y format. We hope to sort these email addresses so that the
mailboxes of the same enterprise can be arranged together, that is, we hope to
arrange them in the order of y first and then x, for example, abc@google.com
and xyz@google.com should be arranged together instead of putting
abc@google.com and abc@apple.com together, but the latter situation will occur
if they are sorted directly in Excel.</span></span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span class=Charf9><span lang=EN-US style='font-family:"Times New Roman","serif"'>We
still use the clipboard, first copy this column of data in Excel, and then
switch to esProc to write code:</span></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=343
 style='border-collapse:collapse;mso-table-layout-alt:fixed;border:none;
 mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:#B2B2B2;
 mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:
 .5pt solid #B2B2B2;mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=41 valign=top style='width:24.85pt;border:solid black 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>
  </td>
  <td width=301 valign=top style='width:180.7pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>A</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=41 style='width:24.85pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></p>
  </td>
  <td width=301 valign=top style='width:180.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=clipboard()</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=41 style='width:24.85pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>2</span></p>
  </td>
  <td width=301 valign=top style='width:180.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=A1.split@n(&quot;@&quot;)</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;page-break-inside:avoid;height:14.15pt'>
  <td width=41 style='width:24.85pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>3</span></p>
  </td>
  <td width=301 valign=top style='width:180.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=A2.sort([~(2),~(1)])</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;page-break-inside:avoid;height:14.15pt'>
  <td width=41 style='width:24.85pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>4</span></p>
  </td>
  <td width=301 valign=top style='width:180.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=A3.concat@n(&quot;@&quot;)</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=41 style='width:24.85pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>5</span></p>
  </td>
  <td width=301 valign=top style='width:180.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>&gt;clipboard(A4)</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Execute it, then switch back to Excel and
paste it in that column with Ctrl-V. It has been arranged as we want.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>We've understood A1. The split@n in A2 first
split the string into a sequence of strings according to the return character,
and then split each member with the separator &quot;@&quot;. There is and will only
be one @ in an email address, so each member string will be split into a
sequence of two members, which are the parts before and after @ respectively.
Then, when sorting with the sort function, write the sequence members in reverse.
In this way, according to the sequence comparison rules, the later part of @
will be compared first and then the front part of @, that is, the order we
want.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>concat() in A4 is the opposite function of
split(). split() is responsible for splitting and concat() is responsible for
concatenating. The @n option indicates doing concat for the 2-layer sequence.
Each member is restored to the original email address string and assembled into
a large string separated by return, but now the order is reasonable. Then use
the clipboard() function to copy it to the clipboard. In Excel, just paste it.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>A4 can also be directly written as </span><span
class=Charf9><span lang=EN-US style='font-family:"Times New Roman","serif"'>A3.sort(~(2),~(1))</span></span><span
lang=EN-US>. The sort() function also supports multi parameter form, which
means comparing the previous parameter first and then the following parameter.
For a sequence with single values, multi parameter sort() is of little
significance, but it will be more convenient for a two-layer sequence. After
learning structured data in the future, multi parameter sort() will be more
common.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Now we are dealing with a single column data
in Excel, how about multiple columns?</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Of course, there's no problem.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>For example, in Excel, we want to sort the
data of each row from small to large.</span></p>

<p class=MsoNormal align=left style='margin-top:7.8pt;margin-right:0cm;
margin-bottom:7.8pt;margin-left:0cm;text-align:left'><span lang=EN-US
style='mso-no-proof:yes'><img border=0 width=605 height=223
src="SPL_Programming.files/image084.jpg" v:shapes="图片_x0020_120"></span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Excel usually sorts by row, and it is
difficult to sort in the column direction. It is easy to implement with SPL.
Select and copy this piece in Excel, and then switch to esProc to execute such
code:</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=343
 style='border-collapse:collapse;mso-table-layout-alt:fixed;border:none;
 mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:#B2B2B2;
 mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:
 .5pt solid #B2B2B2;mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=41 valign=top style='width:24.85pt;border:solid black 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>
  </td>
  <td width=301 valign=top style='width:180.7pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>A</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=41 style='width:24.85pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></p>
  </td>
  <td width=301 valign=top style='width:180.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=clipboard()</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=41 style='width:24.85pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>2</span></p>
  </td>
  <td width=301 valign=top style='width:180.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=A1.split@n(&quot;\</span></span><span
  class=code><span lang=EN-US style='mso-bidi-font-size:10.5pt;font-family:
  "Times New Roman","serif";mso-fareast-font-family:楷体;mso-bidi-font-weight:
  bold'>t</span></span><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>&quot;)</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;page-break-inside:avoid;height:14.15pt'>
  <td width=41 style='width:24.85pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>3</span></p>
  </td>
  <td width=301 valign=top style='width:180.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=A2.(~.sort())</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;page-break-inside:avoid;height:14.15pt'>
  <td width=41 style='width:24.85pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>4</span></p>
  </td>
  <td width=301 valign=top style='width:180.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=A3.concat@n(&quot;\</span></span><span
  class=code><span lang=EN-US style='mso-bidi-font-size:10.5pt;font-family:
  "Times New Roman","serif";mso-fareast-font-family:楷体;mso-bidi-font-weight:
  bold'>t</span></span><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>&quot;)</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=41 style='width:24.85pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>5</span></p>
  </td>
  <td width=301 valign=top style='width:180.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>&gt;clipboard(A4)</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Then paste it back.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The piece of data copied from Excel is a
large string after being received by the clipboard function. Each row is
separated by return, that is, \n, and the columns in each row are separated by
tab(</span><span class=Charf9><span lang=EN-US style='font-family:"Times New Roman","serif"'>\t)</span></span><span
lang=EN-US>. So </span><span lang=EN-US style='mso-bidi-font-size:10.5pt;
mso-fareast-font-family:楷体;mso-bidi-font-weight:bold'>A1.split@n(&quot;\t&quot;)
in A2 </span><span lang=EN-US>can split this large string into a two-layer
sequence, and its inner member is just the data of each cell in Excel; Then
sort each row in A3, concatenate it back into such a \n and \t separated string
in A4, and paste it into Excel.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Look carefully at the results in Excel. It
seems that there is something wrong. It ranks 42 in front of 5. Is the size
wrong?</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>In fact, it's not wrong, because the result
that is split by the split function is still a string, and as a string,
&quot;42&quot; is smaller than &quot;5&quot;.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>So how can we compare by value? We need to
change A3 to:</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>=A2.(~.sort(number(~)))</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Corresponding to string(), number() can
convert a string parameter into numeric type, and then it can be compared and
sorted according to numerical rules. Look now, there's no problem.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Under the previous operating system, there was
a command called grep, which can find the file containing a string and the line
number in many text files. This is a very useful command, which was cancelled
by Windows. Let's implement it by ourselves now.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Assuming that the string to be found is in
A1, let's specify all text files under the path:</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=586
 style='border-collapse:collapse;mso-table-layout-alt:fixed;border:none;
 mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:#B2B2B2;
 mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:
 .5pt solid #B2B2B2;mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=35 valign=top style='width:21.25pt;border:solid black 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>
  </td>
  <td width=67 valign=top style='width:39.95pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>A</span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>B</span></p>
  </td>
  <td width=130 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>C</span></p>
  </td>
  <td width=260 valign=top style='width:155.95pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>D</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=35 style='width:21.25pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></p>
  </td>
  <td width=67 valign=top style='width:39.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>Abc</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
  <td width=484 colspan=3 valign=top style='width:290.6pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=directory@p(&quot;D:/data/*.txt&quot;)</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=35 style='width:21.25pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>2</span></p>
  </td>
  <td width=67 valign=top style='width:39.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>for B1</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
  <td width=224 colspan=2 valign=top style='width:134.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=file(A2).read@n()</span></span></p>
  </td>
  <td width=260 valign=top style='width:155.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=filename(A2)</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=35 style='width:21.25pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>3</span></p>
  </td>
  <td width=67 valign=top style='width:39.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='font-family:
  "Times New Roman","serif";mso-fareast-font-family:楷体;font-weight:normal;
  mso-bidi-font-weight:bold'>&nbsp;</span></span></p>
  </td>
  <td width=95 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>for B2</span></span></p>
  </td>
  <td width=130 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>if pos(B3,A1)</span></span></p>
  </td>
  <td width=260 valign=top style='width:155.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>&gt;output(D2/&quot;\t&quot;/#B3/&quot;\t&quot;/B3)</span></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>We're going to learn a few new functions.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The directory() function in B1 will return
all .txt file names under the specified path (it is better to use the absolute
path, otherwise the file may not be found because the startup path of esProc is
uncertain). These file names will be returned as a string sequence, @p indicating
that the returned file name is also a full path. A2 loops this sequence, B2
reads out each file, and the file() function generates a file object with the
file name, read@n() function reads the text file into a sequence of strings,
one member per line. filename() takes out the part of the path in the full path
file name.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>B3:D3 is easy to understand. Loops through
each line of text, if A1 is found, output the file name, line number and the
content of this line.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Here we assume that the files are small and can
be read in at one time. If the file is large, we need to use the cursor
technology mentioned later.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Counting the number of words in a batch of
articles is also a common exercise. After learning to read files, we can also
practice:</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=609
 style='border-collapse:collapse;mso-table-layout-alt:fixed;border:none;
 mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:#B2B2B2;
 mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:
 .5pt solid #B2B2B2;mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=35 valign=top style='width:21.25pt;border:solid black 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>
  </td>
  <td width=573 valign=top style='width:343.8pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>A</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=35 style='width:21.25pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></p>
  </td>
  <td width=573 valign=top style='width:343.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=directory@p(&quot;D:/book/*.txt&quot;).sum(file(~).read().words().len())</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The read() function without options will read
the whole text file into a large string, and the words() function will disassemble
the words in the large string to form a sequence. Then, just count the length and
add it up. One line is enough.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Let's do another task that may be useful in
daily work: merge a batch of Excel files into a large one.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>We may often collect Excel files of various
periods or departments. The Excel format is the same. These files need to be
combined into a complete file to facilitate further statistics. But manual copy
and paste is very troublesome. If there are dozens or hundreds of files, it
will be very tiresome. This kind of thing is just for the program to do.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Let's assume that the Excel to be merged is
row type, the first row is the title, and then each row is data, such as:</span></p>

<p class=MsoNormal align=left style='margin-top:7.8pt;margin-right:0cm;
margin-bottom:7.8pt;margin-left:0cm;text-align:left'><span lang=EN-US
style='mso-no-proof:yes'><img border=0 width=601 height=232
src="SPL_Programming.files/image086.jpg" v:shapes="图片_x0020_119"></span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>This is a very common Excel file format.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Add a requirement to spell the original Excel
file name into the last column of the merged Excel, so as to distinguish which
file the data comes from.</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=449
 style='border-collapse:collapse;mso-table-layout-alt:fixed;border:none;
 mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:#B2B2B2;
 mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:
 .5pt solid #B2B2B2;mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=35 valign=top style='width:21.25pt;border:solid black 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>A</span></p>
  </td>
  <td width=307 valign=top style='width:184.3pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>B</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=35 style='width:21.25pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></p>
  </td>
  <td width=414 colspan=2 valign=top style='width:248.1pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=directory@p(&quot;D:/data/*.xlsx&quot;)</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=35 style='width:21.25pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>2</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>for A1</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
  <td width=307 valign=top style='width:184.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=file(A2).xlsimport@w()</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;page-break-inside:avoid;height:14.15pt'>
  <td width=35 style='width:21.25pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>3</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='font-family:
  "Times New Roman","serif";mso-fareast-font-family:楷体;font-weight:normal;
  mso-bidi-font-weight:bold'>&nbsp;</span></span></p>
  </td>
  <td width=307 valign=top style='width:184.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=filename@n(A2)</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;page-break-inside:avoid;height:14.15pt'>
  <td width=35 style='width:21.25pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>4</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='font-family:
  "Times New Roman","serif";mso-fareast-font-family:楷体;font-weight:normal;
  mso-bidi-font-weight:bold'>&nbsp;</span></span></p>
  </td>
  <td width=307 valign=top style='width:184.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=B2.to(2,).(~|B3)</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;page-break-inside:avoid;height:14.15pt'>
  <td width=35 style='width:21.25pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>5</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='font-family:
  "Times New Roman","serif";mso-fareast-font-family:楷体;font-weight:normal;
  mso-bidi-font-weight:bold'>&nbsp;</span></span></p>
  </td>
  <td width=307 valign=top style='width:184.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=@|B4</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6;page-break-inside:avoid;height:14.15pt'>
  <td width=35 style='width:21.25pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>6</span></p>
  </td>
  <td width=106 valign=top style='width:63.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='font-family:
  "Times New Roman","serif";mso-fareast-font-family:楷体;font-weight:normal;
  mso-bidi-font-weight:bold'>&nbsp;</span></span></p>
  </td>
  <td width=307 valign=top style='width:184.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=if(#A2==1,B2(1)|&quot;File&quot;,@)</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=35 style='width:21.25pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>7</span></p>
  </td>
  <td width=414 colspan=2 valign=top style='width:248.1pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span class=code><span lang=EN-US style='mso-bidi-font-size:
  10.5pt;font-family:"Times New Roman","serif";mso-fareast-font-family:楷体;
  font-weight:normal;mso-bidi-font-weight:bold'>=file(&quot;D:/all.xlsx&quot;).xlsexport@w([B6]|B5)</span></span><span
  class=code><span lang=EN-US style='font-family:"Times New Roman","serif";
  mso-fareast-font-family:楷体;font-weight:normal;mso-bidi-font-weight:bold'></span></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>filename@n() in B3 will disassemble the part
of the file name with the extension removed, and it can also be done by
splitting a string. xlsimport@w() in B2 will read an Excel file into a
two-layer sequence. Each row of Excel corresponds to one member, and each
column in each row corresponds to the member of its member. B4 removes the
title of the first row and spells the file name to the end of each row. B5
combines these data, while B6 needs to keep one title and spell one more
column.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Finally xlsexport@w() in A7 write the summarized
two-layer sequence </span><span class=Charf9><span lang=EN-US style='font-family:
"Times New Roman","serif"'>[B6]|B5</span></span><span lang=EN-US> into a new
Excel file (it is better to use the absolute path when exporting the file).</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>xlsimport() without @w option can actually
read an Excel file into more convenient data type, and the code to complete
this task will be simpler, but it will be introduced after we talk about
structured data.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>With the in-depth study, we will gradually
enter the phase of handling practical tasks. Processing file data is a very
common task. In the examples of this section, we all use absolute paths to
locate files. Here is a brief introduction to the file search rules of esProc
when using relative paths (absolute paths can be found directly):</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>If the main path is set in the environment
(Chapter 6, section 3), esProc will start from this main path; If the main path
is empty, search from the path where the currently used script file is located.
The current script may have just been created and have not been saved. In this
case, there is no path, so it can not determine where to find it, and it is
likely that it will not be found. Therefore, either set the main path, or the
current script is saved and has the path.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The searching path that was set at the same
time as the main path is used to search the called script, and it has nothing
to do with the data file. Placing the data file in the searching path will not
enable it to be found automatically.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Do some experiments by yourself, and it's
easy to figure it out.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>When we give examples later, we will use a
simple relative path. Please adjust the appropriate system configuration and
the path in the code according to the above introduction.</span></p>
	</div>
	<div id="previous-next">
		<div id="next"><a href="35.html">Next</a></div>
		<div id="previous"><a href="33.html">Previous</a></div>		
	</div>
	<div id="related">
		<div class="related-title"><div class="related-title-left"></div>   Related :</div>
		<div class="related-list"><li><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'><a href="32.html">7 String and time</a></span></li>
</div>
	</div>
	<div id="footer">	
		
		
    <div class="copyright"> Copyright&reg; 2021-2023 <a href="http://www.scudata.com" target="_Blank">SCUDATA Inc. 
      </a></div>
	</div>
</div>

</body>
</html>
