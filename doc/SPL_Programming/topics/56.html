<!--create by iword1.0 pro, http://www.voland.com.cn-->
<!-- saved from url=(0026)http://www.runqian.com.cn/ -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>11.4 Big cursor</title>
<link rel="stylesheet" href="../images/template.css" type="text/css" />
<link rel="stylesheet" href="document.css" type="text/css" />
<script language="JavaScript" src="../resource/url.js"></script>
</head>

<body>

<div id="content-bg">
	<div id="centent">
	<div id="centent-title"><h2 style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;margin-left:
0cm;text-indent:0cm;line-height:normal;mso-list:l11 level2 lfo12;tab-stops:
list 36.0pt left 42.55pt'><span lang=EN-US
style='mso-fareast-font-family:"Times New Roman"'><span style='mso-list:Ignore'>11.4<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><span
lang=EN-US>Big cursor</span></h2></div>
	<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>We haven¡¯t learned the sorting of big data
yet.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Sorting operation is very different. Its
calculation result is as large as the source data. If the source data cannot be
loaded in memory, the result cannot be loaded for sure, but unlike select() and
new(), it cannot be calculated while traversing.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The sorting of big data can only be solved by
using external storage as buffer. The general steps are as follows: read in
some data, sort in memory and write out the result; Then read the next part,
sort and write; ¡­; Finally, a batch of ordered intermediate results will be
obtained, and then the merging algorithm will be used to concatenate these
intermediate results. This process is complex and beyond the design scope of
this book, and we won't talk about the detailed principle here.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>SPL provides the sortx() function to perform
big data sorting. This function implements all the above series of processes. Because
the sorting result is still big data, sortx() will also return a cursor, but it
is not a deferred cursor. sortx() will calculate immediately, and the returned
cursor is based on the intermediate results described above.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>For example, we want to arrange the order data
according to the average unit price from large to small, and then write it to
another file:</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=532
 style='border-collapse:collapse;mso-table-layout-alt:fixed;border:none;
 mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:#B2B2B2;
 mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:
 .5pt solid #B2B2B2;mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=40 valign=top style='width:23.8pt;border:solid black 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>A</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=file(&quot;data.txt&quot;).cursor@t()</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>2</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=A1.sortx(-amount/quantity)</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>3</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=file(&quot;data.csv&quot;).export@ct(A2)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Because sorting is from large to small, sortx()
uses negative number as the parameter. A2 after calculation is a cursor, which
cannot be viewed directly. You can get data with fetch() or write to another
file like A3.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>sortx() calculates immediately. When it
returns after execution, cursor A1 has been traversed. At this time, even
deleting data.txt will not affect the action of A3. This is completely
different from functions like select(). The deferred cursor returned by the
select() function will be traversed synchronously with its basis cursor in the
future.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>As a reminder, sortx() may be slow and need
to wait for some time after running. It also takes up some hard disk space
(used to store intermediate results). esProc will use the operating system
temporary directory by default, or you can set the temporary directory yourself
in the options.</span></p>

<p class=MsoNormal align=left style='margin-top:7.8pt;margin-right:0cm;
margin-bottom:7.8pt;margin-left:0cm;text-align:left'><span lang=EN-US
style='mso-no-proof:yes'><img border=0 width=572 height=382
src="SPL_Programming.files/image141.jpg" v:shapes="Í¼Æ¬_x0020_118"></span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>In fact, sorting for big data itself is not
commonly used. We usually don't care about the full sorting result of big data,
but only the top N. However, sorting is often the basis of other big data operations.
Without an orderly result, other operations are difficult to do.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>For example, big grouping.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>For the groups() function we used before, the
returned result is a table sequence, that is, small data. However, there is
still some kind of group aggregation operation, and its return result will be
so huge that the memory can't fit. At this time, there is no way to use
groups(), which will lead to memory overflow.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>However, as we said earlier, if the data is
in order to the grouping key values, we can use the method of group() function,
to summarize at the same time during the traversal process, and there will be
no overflow. No matter how large the returned grouping result is, it can be calculated
normally.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>For example, we want to do a grouping by two fields
amount and quantity to see how many orders there are in each group with
different amount and quantity. The grouping result may be 1 million lines (it's
not big, but we just regard it as big. Suppose it can't be done with groups()).</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The current data has no order for the combination
of these two fields. After sorting, we can use the group() function.</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=532
 style='border-collapse:collapse;mso-table-layout-alt:fixed;border:none;
 mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:#B2B2B2;
 mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:
 .5pt solid #B2B2B2;mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=40 valign=top style='width:23.8pt;border:solid black 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>A</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=file(&quot;data.txt&quot;).cursor@t()</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>2</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=A1.sortx(amount,quantity)</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;page-break-inside:avoid;height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>3</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=A2.group(amount,quantity)</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;page-break-inside:avoid;height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>4</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=A3.new(amount,quantity,~.count(1):C)</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>5</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=A3.fetch(100)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>In this way, we can calculate out the big
grouping, but because the result is large, we can only fetch() a part to view
or write to another file.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>We can do other calculations based on it. For
example, we want to calculate the total amount and quantity for groups with more
than 5 orders of the same amount and quantity (that is, the summary field
C&gt;5 in A4).</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=532
 style='border-collapse:collapse;mso-table-layout-alt:fixed;border:none;
 mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:#B2B2B2;
 mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:
 .5pt solid #B2B2B2;mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=40 valign=top style='width:23.8pt;border:solid black 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>A</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=file(&quot;data.txt&quot;).cursor@t()</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>2</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=A1.sortx(amount,quantity)</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;page-break-inside:avoid;height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>3</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=A2.group(amount,quantity)</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;page-break-inside:avoid;height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>4</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=A3.new(amount,quantity,~.count(1):C)</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>5</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=A4.select(C&gt;5).total(sum(C*amount),sum(C*quantity))</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The group() function returns a deferred
cursor. We can attach another select() operation, and then traverse it with
total().</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Because big grouping is commonly used, SPL
provides a groupx() function, which does sorting and grouping together. The
above code can be simplified as:</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=532
 style='border-collapse:collapse;mso-table-layout-alt:fixed;border:none;
 mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:#B2B2B2;
 mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:
 .5pt solid #B2B2B2;mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=40 valign=top style='width:23.8pt;border:solid black 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>A</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=file(&quot;data.txt&quot;).cursor@t()</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>2</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=A1.groupx(amount,quantity;count(1):C)</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>3</span></p>
  </td>
  <td width=492 valign=top style='width:295.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=A2.select(C&gt;5).total(sum(C*amount),sum(C*quantity))</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The parameter rules of groupx() are the same
as those of groups(), but it assumes that the returned result set is large, so
it will sort first (actually it is more complex), then do an ordered grouping,
and finally return a cursor. Like sortx(), this is not a deferred cursor. When
the two actions are executed together, not only the syntax is simpler, but also
the execution speed is better. However, like sortx(), it will temporarily
occupy hard disk space.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>In addition to the big grouping, there is also
the big merging calculation.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Similar to the previous example of merging
calculation, if we have two large order files on hand, we need to merge them
(or calculate the intersection), and the data must be orderly in advance.</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=622
 style='border-collapse:collapse;mso-table-layout-alt:fixed;border:none;
 mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:#B2B2B2;
 mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:
 .5pt solid #B2B2B2;mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=40 valign=top style='width:23.8pt;border:solid black 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>
  </td>
  <td width=291 valign=top style='width:174.65pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>A</span></p>
  </td>
  <td width=291 valign=top style='width:174.65pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>B</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></p>
  </td>
  <td width=291 valign=top style='width:174.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=T@c(&quot;data1.txt&quot;)</span></p>
  </td>
  <td width=291 valign=top style='width:174.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=T@c(&quot;data2.txt&quot;)</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>2</span></p>
  </td>
  <td width=291 valign=top style='width:174.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=[A1,B1].mergex@u(id)</span></p>
  </td>
  <td width=291 valign=top style='width:174.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>&gt;T@c(&quot;all.csv&quot;,A2)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Assuming that the data is ordered by id, we
can directly use mergex() to calculate union. The parameters here are the same
as those of merge(), but generally we will not establish a primary key on the
cursor, so we need to write the association key used in the merge operation.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Because the result set may be large, mergex()
also returns a cursor, but it is a deferred cursor and will not traverse
automatically. Unlike select() function, mergex() may generate a deferred
cursor for multiple basis cursors. After traversing it, it will also traverse all
the basis cursors. The previously mentioned select() and other functions only
have one basis cursor.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>The T() function uses the @c option to
generate a cursor, and it will automatically select the opening method according
to the file extension. It can also be used to write out, @c means to write out
the cursor, and the write out method will also be selected according to the
file extension.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Unlike the in-memory merge() function,
mergex() requires that the cursor data must be in order to work, and there is
no @o option.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>After sorting, the operation that can only be
realized by random access can be changed into sequential access. Another
similar case is the join operation. Finding associated records with associated key
values originally requires random access (searching in the data table), but if
the data is in order with associated key, sequential access can achieve the
goal.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>SPL also provides a joinx() function with x
to solve the big join.</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=622
 style='border-collapse:collapse;mso-table-layout-alt:fixed;border:none;
 mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:#B2B2B2;
 mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-yfti-tbllook:1184;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:
 .5pt solid #B2B2B2;mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=40 valign=top style='width:23.8pt;border:solid black 1.0pt;
  border-right:solid windowtext 1.0pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>
  </td>
  <td width=291 valign=top style='width:174.65pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>A</span></p>
  </td>
  <td width=291 valign=top style='width:174.65pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>B</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>1</span></p>
  </td>
  <td width=291 valign=top style='width:174.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=T@c(&quot;data1.txt&quot;)</span></p>
  </td>
  <td width=291 valign=top style='width:174.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=T@c(&quot;data2.txt&quot;)</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=40 style='width:23.8pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='margin-top:7.8pt;margin-right:0cm;margin-bottom:
  7.8pt;margin-left:0cm'><span lang=EN-US style='mso-bidi-font-size:10.5pt'>2</span></p>
  </td>
  <td width=291 valign=top style='width:174.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=joinx(A1:a,id;B1:b,id)</span></p>
  </td>
  <td width=291 valign=top style='width:174.65pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=aff style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
  margin-left:0cm;text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman","serif"'>=A2.fetch(100)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>joinx() can support the homo dimensional
association and primary sub association. It also returns a deferred cursor. The
form of the table sequence fetched from it is similar to that of the join() in
memory. The value of each field is the record in each associated cursor, and
then you can continue to use the new() function to realize further reference
calculation.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Similarly, joinx() supports left join and
full join with @1 and @f. We won't give detailed examples here. You can generate
two data tables with different structures to try to do a big join, and you need
to ensure that the association key is orderly, or you should sort with sortx()
first.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>You may find that there is another situation
we have not mentioned, that is, in the case of foreign key association, the
dimension table is too large to be loaded into memory. When we talked about
switch() and join() related to foreign key on the cursor, the fact table data
comes from the cursor, but the dimension table is still a table sequence in
memory.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>In this case, at present, foreign key can
only be understood as join operation and then implemented by joinx(). If the
data is disordered to the foreign key of the fact table and the primary key of
the dimension table in advance, it needs to be sorted first. Moreover, each
joinx() can only resolve one foreign key association, and multiple foreign keys
have to do joinx() multiple times. While the switch() and join() for the
in-memory dimension table can resolve multiple foreign keys in one traversal.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Unlike select(), groupx() and other functions
that only work for one cursor, mergex and joinx work for multiple cursors. So,
is it possible to merge and join big data and small data together?</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>It does exist. The merging and join operations
of big data and small data are also big data, and the method of big data should
be used. In this case, the small data in memory, that is, the table sequence,
should be converted into a cursor, and then the cursor method should be used
for operation. SPL provides cursor() function to convert the table sequence or
record sequence into a cursor, so that small in-memory data can be simulated
into large data and operated together with a file cursor. There are no more
examples here. You can refer to relevant help documents when you need them.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>We have now learned to use cursor to
implement big data operations, but we can only do it right. Another important
goal of big data computing is to do it fast, which is also a very complex task,
or even a more complex task. Like the traversal reuse technology mentioned
earlier, these contents are far beyond the design scope of this book. Here, we
just give you an impression. The content of how to improve the performance of
big data operation is enough to write another book of the same length. Many
calculation methods need to be redesigned, especially to find ways to avoid
substantive sorting, because sorting is a very slow action.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>In the conventional programming languages for
structured data processing, SQL can deal with big data. SQL even achieves data
size transparency, that is, users do not need to care about the size of data,
which obviously saves people a lot of troubles. This is a huge advantage of
SQL. However, using SQL usually needs to load the data into the database, which
is too complex and beyond the ability of most non professional programmers.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>esProc provides the function of using basic
SQL for files and can support most big data operations, so as to avoid the
trouble of loading data into the database.</span></p>

<p class=MsoNormal style='margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;
margin-left:0cm'><span lang=EN-US>Python is also often used for structured data
calculation, but it has no cursor object, and it is very troublesome when
processing big data. It is equivalent to implementing the cursor action by
yourself, which is basically an impossible task for non professionals.</span></p>
	</div>
	<div id="previous-next">
		<div id="next"><a href="57.html">Next</a></div>
		<div id="previous"><a href="55.html">Previous</a></div>		
	</div>
	<div id="related">
		<div class="related-title"><div class="related-title-left"></div>   Related :</div>
		<div class="related-list"><li><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'><a href="52.html">11 Big data</a></span></li>
</div>
	</div>
	<div id="footer">	
		
		
    <div class="copyright"> Copyright&reg; 2021-2023 <a href="http://www.scudata.com" target="_Blank">SCUDATA Inc. 
      </a></div>
	</div>
</div>

</body>
</html>
